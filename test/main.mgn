#!/usr/bin/env mgn
// standard library tests

std := import('std')
test := import('test')

TestRunners := [
	'std'
	'str'
	'sort'
	'fmt'
	'syntax'
]

// allow selection of tests to run with CLI arguments
TestsToRun := if len(args()) > 2 {
	true -> std.slice(args(), 2)
	_ -> TestRunners
}

t := test.new('Magnolia stdlib')

TestRunners |> std.each(fn(name) if TestsToRun |> std.contains?(name) {
	true -> {
		runner := import(name + '.test')
		runner.run(t)
	}
})

// only report failed tests
t.failed()

// exit with right code
t.exit()

